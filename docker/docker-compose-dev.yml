#  WARNING: This file is autogenerated by make-yaml. Changes here
#  will be overwritten. Edit the corresponding .template file
#  instead.

version: "3"

services:
  crkeng-dev:
    restart: always
    # Specify hostname to make it clearer which container is active when
    # using docker to get a shell in the container.
    hostname: crkeng-dev-container
    image: ghcr.io/ualbertaaltlab/itwewina.altlab.app:dev
    command: /app/app.sh crkeng
    deploy:
      resources:
        limits:
          memory: 2048M
    ports:
      - "8211:8000" # http
      - "9211:9191" # uWSGI stats
    volumes:
      - "./.env:/app/.env"

      # LFS mounts
      - "../src/morphodict/lexicon/resources/vector_models/:/app/src/morphodict/lexicon/resources/vector_models/:ro"
      - "../src/crkeng/resources/fst:/app/src/crkeng/resources/fst:ro"
      - "../src/CreeDictionary/res/fst/:/app/src/CreeDictionary/res/fst/:ro"
      - "../src/CreeDictionary/res/:/app/src/CreeDictionary/res/:ro"
      - "../src/crkeng/resources/dictionary/:/app/src/crkeng/resources/dictionary/:ro"

      - "/data_local/application-data/crkeng-dev/vector_models:/app/src/crkeng/resources/vector_models/"
      - "/data_local/application-data/crkeng-dev/db:/app/src/crkeng/db/"
      - "/data_local/application-data/crkeng-dev/search_quality:/app/src/crkeng/morphodict/search_quality/"
